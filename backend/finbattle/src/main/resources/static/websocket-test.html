<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>FinBattle - Chat, Game & Quiz Test</title>
  <!-- SockJSì™€ StompJS ë¼ì´ë¸ŒëŸ¬ë¦¬ -->
  <script src="https://cdn.jsdelivr.net/npm/sockjs-client/dist/sockjs.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/stompjs/lib/stomp.min.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
      background-color: #fff8f8;
      background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="50" height="50" viewBox="0 0 50 50" fill="none" stroke="%23ffcccc" stroke-width="1"><path d="M25,10 Q30,5 35,10 Q40,15 35,20 Q30,25 25,20 Q20,15 25,10 Z"/><circle cx="20" cy="40" r="3"/><circle cx="30" cy="40" r="3"/></svg>');
      background-size: 100px 100px;
    }

    .section {
      border: 2px solid #ffaaaa;
      padding: 15px;
      margin-bottom: 20px;
      border-radius: 10px;
      background-color: white;
      box-shadow: 0 3px 6px rgba(255, 170, 170, 0.2);
      position: relative;
    }

    .section::after {
      content: "ğŸ¾";
      position: absolute;
      bottom: 5px;
      right: 10px;
      opacity: 0.2;
      font-size: 20px;
    }

    .logBox {
      border: 1px solid #ffcccc;
      padding: 10px;
      height: 100px;
      overflow-y: auto;
      margin-top: 10px;
      background: #fff9f9;
      border-radius: 8px;
    }

    .statusBox {
      border: 1px solid #ffcccc;
      padding: 10px;
      height: 150px;
      overflow-y: auto;
      margin-top: 10px;
      background: #fff0f5;
      border-radius: 8px;
    }

    .userItem {
      margin: 5px 0;
      padding: 3px 8px;
      border-radius: 6px;
      background-color: #fff5f5;
    }

    .correct {
      color: green;
      font-weight: bold;
      margin-left: 10px;
    }

    button {
      padding: 5px 10px;
      margin: 0 5px;
      border-radius: 8px;
      cursor: pointer;
      background-color: #ff9999;
      border: none;
      color: white;
      transition: all 0.2s;
    }

    button:hover {
      background-color: #ff7777;
      transform: translateY(-2px);
    }

    input[type="text"],
    input[type="number"] {
      padding: 5px;
      border-radius: 6px;
      border: 1px solid #ffaaaa;
      background-color: #fffafa;
    }

    h1 {
      color: #ff6b6b;
      text-align: center;
    }

    h1::before, h1::after {
      content: "ğŸ±";
      margin: 0 10px;
    }

    h2 {
      margin-top: 0;
      color: #ff6b6b;
      border-bottom: 2px dotted #ffdddd;
      padding-bottom: 5px;
    }

    .game-buttons {
      text-align: center;
      margin-top: 20px;
      padding: 10px;
      background-color: #fff0f5;
      border-radius: 10px;
      border: 1px dashed #ffaaaa;
    }
  </style>
</head>
<body>
<h1>FinBattle - Chat, Game & Quiz Test</h1>

<!-- (1) ë°© ìƒì„± ì˜ì—­ -->
<div class="section">
  <h2>ë°© ìƒì„±</h2>
  <!-- userId (ë°© ìƒì„±ì ID) -->
  <label>ìƒì„±ì ID:</label>
  <input type="number" id="creatorUserId" placeholder="Enter Creator's User ID"/>

  <br/><br/>
  <label>ë°© ì œëª©:</label>
  <input type="text" id="roomTitle" placeholder="ë°© ì œëª© ì…ë ¥"/>

  <br/><br/>
  <label>ë¹„ë°€ë²ˆí˜¸:</label>
  <input type="text" id="roomPassword" placeholder="ë¹„ë°€ë²ˆí˜¸(ì˜µì…˜)"/>

  <br/><br/>
  <label>ìµœëŒ€ ì¸ì› ìˆ˜:</label>
  <input type="number" id="maxPlayer" placeholder="ì˜ˆ) 4"/>

  <br/><br/>
  <!-- RoomTypeì„ selectë¡œ ë³€ê²½ -->
  <label>ë°© ìœ í˜•:</label>
  <select id="roomType">
    <option value="ONE_ON_ONE">1ëŒ€1 ë°©</option>
    <option value="MULTI">ë‹¤ì¸ì „</option>
    <option value="AI_BATTLE">AI ë°°í‹€</option>
  </select>

  <br/><br/>
  <!-- QuizTypeì„ selectë¡œ ë³€ê²½ -->
  <label>í€´ì¦ˆ ìœ í˜•:</label>
  <select id="quizType">
    <option value="FIN_KNOWLEDGE">ê¸ˆìœµ ì§€ì‹</option>
    <option value="FIN_CRIME">ê¸ˆìœµ ë²”ì£„</option>
    <option value="FIN_POLICY">ê¸ˆìœµ ì •ì±…</option>
    <option value="FIN_PRODUCT">ê¸ˆìœµ ìƒí’ˆ</option>
    <option value="FIN_INVESTMENT">ê¸ˆìœµ íˆ¬ì</option>
  </select>

  <br/><br/>
  <button onclick="createRoom()">Create Room</button>
  <!-- ë°© ìƒì„± ê²°ê³¼ë¥¼ í‘œì‹œí•  ì˜ì—­ -->
  <div id="createRoomResult" class="logBox"></div>
</div>

<!-- (2) ë°© ì ‘ì† ì˜ì—­ -->
<div class="section">
  <h2>ë°© ì ‘ì†</h2>
  <label>Room ID: </label>
  <input type="text" id="roomId" placeholder="Enter Room ID"/>
  <label>User ID: </label>
  <input type="text" id="userId" placeholder="Enter Your ID"/>
  <button onclick="connect()">Connect</button>
</div>

<!-- (3) ì ‘ì† ìƒíƒœ ì˜ì—­ -->
<div class="section">
  <h2>Online Users</h2>
  <div id="userStatus" class="statusBox"></div>
</div>

<!-- ë°© ëª©ë¡ ì¶œë ¥ ì˜ì—­ -->
<div class="section">
  <h2>ë°© ëª©ë¡ (OPEN ìƒíƒœë§Œ)</h2>
  <button onclick="loadOpenRooms()">ë°© ëª©ë¡ ìƒˆë¡œê³ ì¹¨</button>
  <div id="roomList" class="logBox"></div>
</div>

<!-- ë°© ì •ë³´ ì˜ì—­ -->
<div class="section">
  <h2>Room Info</h2>
  <button onclick="requestRoomInfo()">Get Room Info</button>
  <div id="roomInfo" class="logBox"></div>
</div>


<!-- [ì¶”ê°€] ê°•í‡´, ì¤€ë¹„ ë²„íŠ¼ ì˜ì—­ -->
<div class="section">
  <h2>Room Controls</h2>
  <!-- ë‹¤ë¥¸ ì‚¬ìš©ìë¥¼ ê°•í‡´í•  ìˆ˜ ìˆëŠ” UI ì˜ˆì‹œ -->
  <label>Target User ID to kick: </label>
  <input type="text" id="kickUserId" placeholder="Enter target user ID"/>
  <button onclick="kickUser()">Kick User</button>
  <br/><br/>
  <!-- ìì‹ ì„ ready ìƒíƒœë¡œ ë§Œë“¤ê¸° -->
  <button onclick="setReady()">I'm Ready</button>
  <div class="logBox" id="controlLog"></div>
</div>

<!-- (4) ì±„íŒ… ì˜ì—­ -->
<div class="section">
  <h2>Chat</h2>
  <label>Message: </label>
  <input type="text" id="chatMessage" placeholder="Type your chat message"/>
  <button onclick="sendChat()">Send Chat</button>
  <div id="chatLog" class="logBox"></div>
</div>

<!-- (5) í€´ì¦ˆ ì˜ì—­ -->
<div class="section">
  <h2>Quiz</h2>
  <button onclick="getQuiz()">Get Quiz Question</button>
  <button onclick="requestQuizHint()">Get Quiz Hint</button>
  <div id="quizQuestion" class="logBox"></div>
  <br/>
  <input type="text" id="quizAnswer" placeholder="Your Answer"/>
  <button onclick="submitQuizAnswer()">Submit Answer</button>
  <div id="quizResult" class="logBox"></div>
</div>

<!-- (6) ê²Œì„ ì •ë³´ ì˜ì—­ -->
<div class="game-buttons">
  <button onclick="requestGameInfo()">Get Game Info</button>
  <button onclick="requestGameHint()">Request Game Hint</button>
  <button onclick="startGame()">ğŸ”¥ Start Game</button>
</div>

<!-- ë¡œê·¸ í‘œì‹œìš© (ìˆ¨ê¹€) -->
<div id="gameInfo" style="display: none;"></div>
<div id="gameHint" style="display: none;"></div>

<script>
  let stompClient = null;
  let currentUserId = null;
  let users = {};

  document.addEventListener('DOMContentLoaded', function () {
    const quizAnswerInput = document.getElementById('quizAnswer');
    if (quizAnswerInput) {
      quizAnswerInput.addEventListener('keypress', function (event) {
        if (event.key === 'Enter') {
          submitQuizAnswer();
        }
      });
    }
  });

  // ========== (A) ë°© ìƒì„± í•¨ìˆ˜ (RoomCreateRequest -> RoomResponse) ==========
  function createRoom() {
    const creatorId = document.getElementById('creatorUserId').value;
    const title = document.getElementById('roomTitle').value;
    const password = document.getElementById('roomPassword').value;
    const maxPlayer = document.getElementById('maxPlayer').value;
    const roomType = document.getElementById('roomType').value;
    const quizType = document.getElementById('quizType').value;

    if (!creatorId || !title || !maxPlayer || !roomType) {
      alert("ìƒì„±ì ID, ë°© ì œëª©, ìµœëŒ€ ì¸ì› ìˆ˜, ë°© ìœ í˜•ì€ í•„ìˆ˜ í•­ëª©ì…ë‹ˆë‹¤.");
      return;
    }

    // RoomCreateRequestì— ë§ì¶° JSON ë°ì´í„°ë¥¼ êµ¬ì„±
    const payload = {
      memberId: parseInt(creatorId, 10),
      roomTitle: title,
      password: password,
      maxPlayer: parseInt(maxPlayer, 10),
      roomType: roomType,
      quizType: quizType
    };

    // --- ìƒˆ ë°±ì—”ë“œ: /api/room POSTë¡œ Room ìƒì„± ---
    fetch('/api/room', {
      method: 'POST',
      headers: {'Content-Type': 'application/json'},
      body: JSON.stringify(payload)
    })
    .then(response => {
      if (!response.ok) {
        throw new Error(`ì„œë²„ ì‘ë‹µ ì—ëŸ¬: ${response.status}`);
      }
      return response.json();
    })
    .then(data => {
      // dataëŠ” RoomResponse í˜•íƒœ (roomId, roomTitle, status, roomType, quizType, maxPlayer, createdAt ë“±)
      const resultDiv = document.getElementById('createRoomResult');
      resultDiv.innerHTML = `
        <strong>ë°© ìƒì„± ì„±ê³µ!</strong><br/>
        Room ID: ${data.roomId}<br/>
        Title: ${data.roomTitle}<br/>
        Status: ${data.status}<br/>
        RoomType: ${data.roomType}<br/>
        QuizType: ${data.quizType}<br/>
        MaxPlayer: ${data.maxPlayer}<br/>
        CreatedAt: ${data.createdAt}
      `;

      // ë°© ì ‘ì† ì„¹ì…˜ì— roomId, userIdë¥¼ ìë™ ì„¤ì •
      document.getElementById('roomId').value = data.roomId;
      document.getElementById('userId').value = creatorId;

      // ë°© ìƒì„±ì´ ì™„ë£Œë˜ë©´ ê³§ë°”ë¡œ connect() í˜¸ì¶œ
      connect();
    })
    .catch(error => {
      console.error("ë°© ìƒì„± ì‹¤íŒ¨:", error);
      alert("ë°© ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ì½˜ì†”ì„ í™•ì¸í•˜ì„¸ìš”.");
    });
  }

  function loadOpenRooms() {
    fetch('/api/room/open')
    .then(response => {
      if (!response.ok) {
        throw new Error(`ì„œë²„ ì˜¤ë¥˜: ${response.status}`);
      }
      return response.json();
    })
    .then(rooms => {
      const roomListDiv = document.getElementById('roomList');
      roomListDiv.innerHTML = ''; // ê¸°ì¡´ ëª©ë¡ ì´ˆê¸°í™”

      if (rooms.length === 0) {
        roomListDiv.innerHTML = '<p>í˜„ì¬ ìƒì„±ëœ OPEN ë°©ì´ ì—†ìŠµë‹ˆë‹¤.</p>';
        return;
      }

      rooms.forEach(room => {
        const roomElement = document.createElement('div');
        roomElement.classList.add('userItem'); // ìŠ¤íƒ€ì¼ ì ìš©
        roomElement.innerHTML = `
                <strong>ë°© ì œëª©:</strong> ${room.roomTitle} <br/>
                <strong>ë°© ID:</strong> ${room.roomId} <br/>
                <strong>ì¸ì›:</strong> ${room.members ? room.members.length : 0} / ${room.maxPeople} <br/>
                <strong>ìƒíƒœ:</strong> ${room.status} <br/>
                <button onclick="joinRoom(${room.roomId})">ì…ì¥</button>
            `;
        roomListDiv.appendChild(roomElement);
      });
    })
    .catch(error => {
      console.error("ë°© ëª©ë¡ ë¶ˆëŸ¬ì˜¤ê¸° ì‹¤íŒ¨:", error);
      alert("ë°© ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
    });
  }

  // ========== (B) ë°© ì ‘ì† í•¨ìˆ˜ ==========
  function connect() {
    const socket = new SockJS('/ws/firechat');
    stompClient = Stomp.over(socket);
    stompClient.connect({}, function (frame) {
      console.log('âœ… WebSocket Connected:', frame);

      const roomId = document.getElementById('roomId').value;
      currentUserId = document.getElementById('userId').value || 'Anonymous';

      // --- ìƒˆ ë°±ì—”ë“œ: ë°©ì— ë“¤ì–´ê°€ê¸° ---

      console.log(`ğŸŸ¢ êµ¬ë… ìš”ì²­: /topic/room/${roomId}`);

      // --- ì±„íŒ… êµ¬ë… (/topic/chat/{roomId}) ---
      stompClient.subscribe(`/topic/chat/${roomId}`, function (msg) {
        const chatMessage = JSON.parse(msg.body);
        appendLog('chatLog', `${chatMessage.sender}: ${chatMessage.content}`);
      });

      // --- ìƒˆ ë°±ì—”ë“œ: ë°© ì´ë²¤íŠ¸ êµ¬ë… ---
      stompClient.subscribe(`/topic/room/${roomId}`, function (message) {
        console.log("ğŸŸ¢ Room Info Received:", message.body);

        const eventData = JSON.parse(message.body);
        console.log(1111);
        console.log("Room Event Received:", eventData);
        console.log(2222);

        // ì´ë²¤íŠ¸ ìœ í˜•ë³„ ì²˜ë¦¬ (JOIN, LEAVE, KICK, READY ë“±)
        if (eventData.event === "KICK") {
          appendLog('controlLog',
              `User ${eventData.targetUserId} was kicked from room ${eventData.roomId}`);
        } else if (eventData.event === "KICK_FAIL") {
          appendLog('controlLog', `Kick failed: ${eventData.reason}`);
        } else if (eventData.event === "READY") {
          appendLog('controlLog', `User ${eventData.userId} is ready!`);
        } else if (eventData.event === "READY_FAIL") {
          appendLog('controlLog', `Ready failed: ${eventData.reason}`);
        } else if (eventData.event === "JOIN") {
          appendLog('controlLog', `User ${eventData.userId} joined the room`);
        } else if (eventData.event === "JOIN_FAIL") {
          appendLog('controlLog', `Join failed: ${eventData.reason}`);
        } else if (eventData.event === "LEAVE") {
          appendLog('controlLog', `User ${eventData.userId} left the room`);
        } else if (eventData.event === "DELETE") {
          appendLog('controlLog', `Room ${eventData.roomId} has been deleted`);
        } else if (eventData.event === "COUNT") {
          appendLog('controlLog', `User Count: ${eventData.userCount}`);
        } else if (eventData.event === "INFO") {
          console.log("Room Info Received:", eventData)
          displayRoomInfo(eventData.roomData);
        }
      });

      //topic/game
      // stompClient.subscribe(`/topic/game/${roomId}`, function (message) {
      //   const gameData = JSON.parse(message.body);
      //   console.log("ğŸŸ¢ Game Event Received:", gameData);
      //
      //   switch (gameData.event) {
      //     case "quiz":
      //       document.getElementById('quizQuestion').textContent = "Question: "
      //           + gameData.data.question;
      //       break;
      //     case "quizResult":
      //       document.getElementById(
      //           'quizResult').textContent = `Result: ${gameData.data.result} (User: ${gameData.data.userId})`;
      //       break;
      //     default:
      //       console.warn("Unknown Game Event:", gameData);
      //   }
      // });

      stompClient.onclose = function () {
        console.log("ğŸ”´ WebSocket ì—°ê²° ëŠì–´ì§");
      };

      stompClient.send(`/app/room/${roomId}/join/${currentUserId}`, {}, {});
    });
  }

  // ========== (C) ì±„íŒ… ì „ì†¡ ==========
  function sendChat() {
    const roomId = document.getElementById('roomId').value;
    const content = document.getElementById('chatMessage').value;
    if (!roomId || !content || !currentUserId) {
      return;
    }
    const msgObj = {sender: currentUserId, content: content, roomId: roomId};
    // ìƒˆ ë°±ì—”ë“œ: ì±„íŒ… ì „ì†¡ ê²½ë¡œ ì˜ˆì‹œ (ë³€ê²½ ê°€ëŠ¥)
    stompClient.send(`/app/chat/${roomId}`, {}, JSON.stringify(msgObj));
    document.getElementById('chatMessage').value = '';
  }

  // ========== (D) ê¸°íƒ€ ê¸°ëŠ¥ ìš”ì²­ ==========
  function requestGameInfo() {
    // (ì˜ˆì‹œ) ì‚¬ìš© ì¤‘ì´ë©´ ìœ ì§€, ê·¸ë ‡ì§€ ì•Šë‹¤ë©´ ì‚­ì œ ê°€ëŠ¥
    const roomId = document.getElementById('roomId').value;
    if (!roomId) {
      return;
    }
    stompClient.send(`/app/game/${roomId}/getInfo`, {}, {});
    alert("ê²Œì„ ì •ë³´ ìš”ì²­ì´ ì „ì†¡ë˜ì—ˆìŠµë‹ˆë‹¤.");
  }

  function requestGameHint() {
    // (ì˜ˆì‹œ) ì‚¬ìš© ì¤‘ì´ë©´ ìœ ì§€, ê·¸ë ‡ì§€ ì•Šë‹¤ë©´ ì‚­ì œ ê°€ëŠ¥
    const roomId = document.getElementById('roomId').value;
    if (!roomId) {
      return;
    }
    stompClient.send(`/app/game/${roomId}/hint`, {}, {});
    alert("ê²Œì„ íŒíŠ¸ ìš”ì²­ì´ ì „ì†¡ë˜ì—ˆìŠµë‹ˆë‹¤.");
  }

  function getQuiz() {
    const roomId = document.getElementById('roomId').value;
    if (!roomId) {
      return;
    }
    stompClient.send(`/app/game/${roomId}/getQuiz`, {}, {});
  }

  function requestQuizHint() {
    const roomId = document.getElementById('roomId').value;
    if (!roomId) {
      return;
    }
    stompClient.send(`/app/game/${roomId}/quizHint`, {}, {});
  }

  function submitQuizAnswer() {
    const roomId = document.getElementById('roomId').value;
    const answer = document.getElementById('quizAnswer').value;
    if (!roomId || !answer || !currentUserId) {
      return;
    }
    const payload = {userAnswer: answer, memberId: currentUserId};
    stompClient.send(`/app/game/${roomId}/checkAnswer`, {}, JSON.stringify(payload));
    document.getElementById('quizAnswer').value = '';
  }

  // ========== (E) UI ì—…ë°ì´íŠ¸ í•¨ìˆ˜ë“¤ ==========
  function appendLog(elementId, message) {
    const logDiv = document.getElementById(elementId);
    const newLine = document.createElement('div');
    newLine.textContent = message;
    logDiv.appendChild(newLine);
    logDiv.scrollTop = logDiv.scrollHeight;
  }

  // [ì¶”ê°€] ë°© ì •ë³´ ìš”ì²­ í•¨ìˆ˜
  function requestRoomInfo() {
    const roomId = document.getElementById('roomId').value;
    if (!roomId) {
      alert("Room IDë¥¼ ì…ë ¥í•˜ì„¸ìš”!");
      return;
    }

    console.log(`Requesting room info for Room ID: ${roomId}`);
    stompClient.send(`/app/room/${roomId}/info`, {}, {});
  }

  // [ì¶”ê°€] ë°© ì •ë³´ í‘œì‹œ
  function displayRoomInfo(roomData) {
    const infoBox = document.getElementById('roomInfo');

    console.log(roomData.roomId);
    if (!roomData) {
      infoBox.innerHTML = "<strong>ë°© ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</strong>";
      return;
    }

    let membersHTML = "";
    if (roomData.members && roomData.members.length > 0) {
      roomData.members.forEach(m => {
        membersHTML += `<div> - User: ${m.memberId}, State: ${m.status}</div>`;
      });
    } else {
      membersHTML = "<div>(No members found)</div>";
    }

    infoBox.innerHTML = `
        <div><strong>Room ID:</strong> ${roomData.roomId}</div>
        <div><strong>Max People:</strong> ${roomData.maxPeople}</div>
        <div><strong>Status:</strong> ${roomData.status}</div>
        <div><strong>Host:</strong> ${roomData.host ? roomData.host.memberId : 'None'}</div>
        <div><strong>Members:</strong> ${membersHTML}</div>
    `;
  }

  // [ì¶”ê°€] ê°•í‡´(kick)
  function kickUser() {
    const roomId = document.getElementById('roomId').value;
    const targetUserId = document.getElementById('kickUserId').value;
    if (!roomId || !targetUserId) {
      alert("Room IDì™€ Kick ëŒ€ìƒ User IDê°€ í•„ìš”í•©ë‹ˆë‹¤.");
      return;
    }
    stompClient.send(`/app/room/${roomId}/kick/${targetUserId}`, {}, {});
  }

  // [ì¶”ê°€] ì¤€ë¹„(ready)
  function setReady() {
    const roomId = document.getElementById('roomId').value;
    if (!roomId || !currentUserId) {
      return;
    }
    stompClient.send(`/app/room/${roomId}/ready/${currentUserId}`, {}, {});
  }

  function startGame() {
    const roomId = document.getElementById('roomId').value;
    if (!roomId) {
      alert("Room IDë¥¼ ì…ë ¥í•˜ì„¸ìš”!");
      return;
    }

    console.log(`ğŸ”¥ Sending start game request for Room ID: ${roomId}`);

    // ê²Œì„ ê´€ë ¨ WebSocket êµ¬ë… ì„¤ì • (í•œ ë²ˆë§Œ ì‹¤í–‰ë˜ë„ë¡ í™•ì¸)
    if (!stompClient.subscribedToGame) {
      stompClient.subscribe(`/topic/game/${roomId}`, function (message) {
        const gameData = JSON.parse(message.body);
        console.log("ğŸŸ¢ Game Event Received:", gameData);

        switch (gameData.event) {
          case "USER_STATUS":  // âœ… ê²Œì„ ì‹œì‘ í›„ ì‚¬ìš©ì ìƒíƒœë¥¼ ë°›ìŒ
            displayUserStatus(gameData.data);
            break;
          case "GAME_START":
            alert("ê²Œì„ì´ ì‹œì‘ë˜ì—ˆìŠµë‹ˆë‹¤!");
            break;
          case "QUIZ":
            document.getElementById('quizQuestion').textContent = "Question: "
                + gameData.data.data.question;
            break;
          case "QUIZ_RESULT":
            document.getElementById(
                'quizResult').textContent = `Result: ${gameData.data.data.result} (User: ${gameData.data.data.userId})`;
            break;
          case "QUIZ_HINT":
            document.getElementById('quizQuestion').textContent +=
                `HINT1: ${gameData.data.data.hint1} HINT2: ${gameData.data.data.hint2}`;
            break;
          default:
            console.warn("âš ï¸ Unknown Game Event:", gameData);
        }
      });

      stompClient.subscribedToGame = true;
    }

    // WebSocket ë©”ì‹œì§€ ì „ì†¡ -> ê²Œì„ ì‹œì‘ ìš”ì²­
    stompClient.send(`/app/game/${roomId}/start`, {}, {});

    alert("ê²Œì„ ì‹œì‘ ìš”ì²­ì´ ì „ì†¡ë˜ì—ˆìŠµë‹ˆë‹¤!");
  }

  function displayUserStatus(userStatusList) {
    const userStatusBox = document.getElementById('userStatus');

    if (!userStatusList || userStatusList.length === 0) {
      userStatusBox.innerHTML = "<strong>í˜„ì¬ ìœ ì € ì •ë³´ ì—†ìŒ</strong>";
      return;
    }

    let statusHTML = "<h3>ğŸ”¥ Current Player Status</h3>";
    userStatusList.forEach(user => {
      statusHTML += `<div>ğŸ”¹ User ID: ${user.userId}, Life: ${user.life}</div>`;
    });

    userStatusBox.innerHTML = statusHTML;
  }

</script>
</body>
</html>